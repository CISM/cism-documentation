
\section{Higher-Order Test Cases}
\label{sc:ho-tests}

The higher-order test cases are designed to test various aspects of higher-order dycores.
By default they all currently use the GLISSADE dycore.  Other higher-order dycores can be applied
to these same tests as they become available and additional test cases will be added as needed.

% =====================================
\subsection{Dome}
% =====================================
The ``Dome'' test case is based on a parabolic dome of ice, similar to the Halfar dome test case.
By default the Dome has the same radius and the same center thickness as the Halfar case.
However, it uses a simple square root function for defining thickness as a function 
of distance from the dome center, which results in a somewhat steeper profile.  
The Dome has been a primary test used for day-to-day testing of higher-order
test cases because it is simple and relatively fast to run.  It is a good test
to confirm that basic higher-order model physics is working correctly, but does
not strenuously test the model physics, a range of boundary conditions, or analytically verify the model.

\subsubsection{Provided Files}

\begin{itemize}
	\item README \\
		Information about the test case, including technical details about running it.
	\item dome.py \\
		The script to setup and run the test test.
 	 \item dome.config \\
  		The default configuration settings for running CISM with the test case.
	\item dome.forcing.py \\
		A optional script for setting up an example of a CISM time-dependent forcing file.
  	\item dome.forcing.config \\
  		An example configuration script that can be used to run CISM with the forcing file
  		generated by \texttt{dome.forcing.py}
\end{itemize}

\subsubsection{Running the test}
One script sets up the initial condition and runs the model:

\texttt{./dome.py}

There is not a script for analyzing the results.

\textit{Optional:  Time-dependent forcing example}

The Dome test case can be used to setup an example of how to use CISM's time-dependent
forcing capability.  (See Section \ref{ug.sec.config} for more details about time-dependent
forcing.)  To create a forcing file with some time-varying (though arbitrary) forcing, run:

\texttt{./dome.forcing.py}

Then you can run the model using the \texttt{dome.forcing.config} configuration file:

\texttt{./dome.py -c dome.forcing.config}

or

\texttt{./cism\_driver dome.forcing.config}


\subsubsection{Results}
There is not an analytic solution for this test, nor is there a script to analyze
the results.  You can manually inspect the results using a tool such as \texttt{ncview}.\footnote{See section \ref{sec:install-netcdf}}
Sample output is shown in Figure \ref{fig:domeresults}.
\begin{figure}[H!]
	\centering
	\includegraphics[width=7.0cm]{\dir/dome-output.eps}
	\caption{Dome velnorm (i.e., the ice speed in m/yr) field at time 0 using default \texttt{dome.config} settings. This figure is a screenshot of ncview.}
	\label{fig:domeresults}
\end{figure}
\FloatBarrier

% =====================================
\subsection{ISMIP-HOM}
% =====================================
The Ice Sheet Model Intercomparison Project for Higher-Order Models (ISMIP-HOM)
prescribes a set of experiments meant to test the implementation of higher-order physics.  
For more information, see \href{http://homepages.ulb.ac.be/~fpattyn/ismip/}{here}
\footnote{http://homepages.ulb.ac.be/~fpattyn/ismip/} and the ISMIP-HOM description paper by \citet{Pattyn2008}.

The python scripts provided (runISMIPHOM.py and plotISMIPHOM.py, refered to in the following as the ISMIP-HOM 
scripts) were created to run experiments A through F using CISM and compare the results with results from other models. 

Note: The \texttt{README} file describes many additional details about running and analyzing the
test case that are not described here.

\subsubsection{Provided Files}

\begin{itemize}
	\item README \\
		Information about the test case, including technical details about running it.
	\item ishom.config \\
		A default configuration file used as a template for generating the .config file for each test.
    		If you wish to run the tests with different solver settings, for example, you should edit this file.
	\item runISMIPHOM.py \\
		The script used for running any/all of the ISMIP-HOM experiments.  
    		Invoke with `- - help' to see the many command line options for controlling execution.
  \item plotISMIPHOM.py \\
		The script used for analyzing/plotting any/all of the ISMIP-HOM experiments.  
    		Invoke with `- - help' to see the many command line options for controlling execution.
\end{itemize}

\subsubsection{Running the test}
One script sets up the initial condition and runs the model:

\texttt{./runISMIPHOM.py}

and another is used to analyze the results:

\texttt{./plotISMIPHOM.py}

\subsubsection{Results}
The \texttt{plotISMIPHOM.py} script will plot results relative to other models.
None of the ISMIP-HOM tests have a useful analytic solution, so these tests are
used as community benchmarks rather than actual model verification tests.
Therefore, the \citet{Pattyn2008} paper is useful for intepreting model results.
An example output plot is shown in Figure \ref{fig:ismiphom-results}.

\begin{figure}[H!]
	\centering
	\includegraphics[width=10.0cm]{\dir/ISMIP-HOM-A-cis1.eps}
	\caption{An example of the ISMIP-HOM test case output for test A at size L=160 km. 
CISM output is shown with black line and the range of output from other models is shown by colored bars. 
This figure was generated with \texttt{./plotISMIPHOM.py -e a -s 160} after running the test with \texttt{./runISMIPHOM.py -e a -s 160}.
Additional options (e.g., running and plotting for multiple tests simultaneously) are described in the \texttt{README} and by invoking the
`- - help' option at the command line.}
	\label{fig:ismiphom-results}
\end{figure}
\FloatBarrier

% =====================================
\subsection{Stream}
% =====================================

This test case simulates flow over an idealized ice stream underlain by a subglacial till with a known and specified
yield stress distribution (also, see discussion in Section \ref{sc:higher-order-bcs}). For the two distributions available in this test case, 
analytical solutions are available from \citet{Raymond2000} and \citet{Schoof2006}. 

For the Raymond test case, the yield stress within the ice stream is given a uniform value below the driving stress, and outside of the
ice stream it is given a uniform value much higher than the driving stress (i.e., the yield stress distribution is approximated by a
``step" function). For the Schoof test case, the till yield stress across the ice stream is given by a continuously varying function.

In both cases, the basal properties vary in the across-flow direction only and are symmetric about the ice stream centerline.
As a result, the velocity solutions are also uniform along flow and symmetric about the centerline.

\subsubsection{Provided Files}

\begin{itemize}
	\item README \\
		Information about the test case, including technical details about running it.
	\item runStream.py \\
		The script to setup and run the test test.
	\item stream.config.in \\
  The default configuration settings for running CISM with the test case. Note that this
  file is parsed by the runStream.py script. Most of the relevant options that might be changed
  for this test case (e.g., grid spacing) can be done so from the command line, without having to
  edit the .config files (use \texttt{./runStream.py --help} to obtain a description of available options.
  The choice of test case - using the Raymond or Schoof yield stress distribution -  can be toggled 
  by editing line 15 of the runStream.py script.
\end{itemize}

\subsubsection{Running the test}
One script sets up the initial condition and runs the model:

\texttt{./runStream.py}

and another is used to analyze the results:

\texttt{./plotStream.py}

\subsubsection{Results}
The \texttt{plotStream.py} script will plot model output relative to the analytical solutions
given in \citet{Raymond2000} and \citet{Schoof2006}. The choice of analytical solution to compare
to is decided on automatically, based on what value is currently active in the runStream.py script. 
Example output for both test cases is shown in Figure \ref{fig:stream-results}.
	
\begin{figure}[H!]
  \begin{center}
	\includegraphics[width=10.0cm]{\dir/stream_raymond.eps}
	\includegraphics[width=10.0cm]{\dir/stream_schoof.eps}
  \end{center}
  \caption{Comparison between CISM model output (black) and analytic solution (red) for the Raymond (top) and Schoof (bottom) stream test cases. This figure was generated with \texttt{./plotStream.py} after running the test with \texttt{./runStream.py}.
Additional runtime options are described in the \texttt{README} and by invoking the `- - help' option at the command line.}
  \label{fig:stream-results}
\end{figure} 

% =====================================
\subsection{Confined Shelf}
% =====================================
This test setup is from tests 3 and 4 from the idealized (i.e. not Ross) EISMINT-shelf test 
cases.  It simulates the flow within an idealized, 500 m thick ice shelf in a 
confined, rectangular embayment.  Grounded ice is not explicitly modeled but included in the 
model setup as Dirichlet boundary conditions for velocity along the ice shelf edges.
More detailed information on this test case can be found 
\href{http://homepages.vub.ac.be/~phuybrec/eismint/iceshelf.html}{here}
\footnote{http://homepages.vub.ac.be/~phuybrec/eismint/iceshelf.html} in the 
``shelf-descr.pdf" document.

Note that the Confined Shelf and Circular Shelf experiments are both in the 
\texttt{tests/higher-order/shelf} directory and share some files.

\subsubsection{Provided Files}

\begin{itemize}
	\item README \\
		Information about the test case, including technical details about running it.
	\item confined-shelf.py \\
		The script to setup and run the test test.
	\item confined-shelf.config \\
  The default configuration settings for running CISM with the test case.
\end{itemize}

\subsubsection{Running the test}
One script sets up the initial condition and runs the model:

\texttt{./confined-shelf.py}

\subsubsection{Results}
There is not a script for analyzing the results.  See the URL above for information 
about assessing the model output.
You can manually inspect the results using a tool such as \texttt{ncview}.
An example is shown in Figure \ref{fig:confinedshelf-results}.

\begin{figure}[H!]
	\centering
	\includegraphics[width=8.0cm]{\dir/confinedshelf-output.eps}
	\caption{Confined shelf velnorm field using default \texttt{confined-shelf.config} settings. This figure is a screenshot of ncview.}
	\label{fig:confinedshelf-results}
\end{figure}
\FloatBarrier

% =====================================
\subsection{Circular Shelf}
% =====================================
This test is a variant on the confined shelf test case discussed above. It simulates the flow within a circular ice shelf with a uniform thickness
of 1000 m, which is grounded at a single grid point at its center. This test case confirms a working ``floating ice" boundary condition implementation
in two dimensions (i.e, in map plane view) and also confirms radial symmetry. 

Note that the Confined Shelf and Circular Shelf experiments are both in the 
\texttt{tests/higher-order/shelf} directory and share some files.

\subsubsection{Provided Files}

\begin{itemize}
	\item README \\
		Information about the test case, including technical details about running it.
	\item circular-shelf.py \\
		The script to setup and run the test test.
	\item circular-shelf.config \\
  The default configuration settings for running CISM with the test case.
\end{itemize}

\subsubsection{Running the test}
One script sets up the initial condition and runs the model:

\texttt{./circular-shelf.py}

\subsubsection{Results}
There is not a script for analyzing the results.
You can manually inspect the results using a tool such as \texttt{ncview}.
An example is shown in Figure \ref{fig:circularshelf-results}.

\begin{figure}[H!]
	\centering
	\includegraphics[width=8.0cm]{\dir/circularshelf-output.eps}
	\caption{Circular shelf velnorm field using default \texttt{circular-shelf.config} settings. This figure is a screenshot of ncview.}
	\label{fig:circularshelf-results}
\end{figure}
\FloatBarrier

% =====================================
\subsection{Ross Ice Shelf}
% =====================================
This experiment was designed to simulate the flow of the Ross Ice Shelf of Antarctica under idealized conditions (e.g., constant and uniform
flow-law rate factor). For more information about the experiment and its results see 
\href{http://homepages.vub.ac.be/~phuybrec/eismint/iceshelf.html}{here}\footnote{http://homepages.vub.ac.be/~phuybrec/eismint/iceshelf.html}. 
Also, see \citet{MacAyeal:1996vn} for a discussion of the official model intercomparison results.

This experiment will typically take about 10 minutes to run on a single processor.

\subsubsection{Provided Files}

\begin{itemize}
	\item README \\
		Information about the test case, including technical details about running it.
	\item runRoss.py \\
		The script to setup and run the test test.
	\item ross.config \\
  The default configuration settings for running CISM with the test case.
	\item plotRoss.py \\
		The script to plot the test results.
\end{itemize}

\subsubsection{Running the test}
One script sets up the initial condition and runs the model:

\texttt{./runRoss.py}

and another can be used to visualize the results:

\texttt{./plotRoss.py}

\subsubsection{Results}
The \texttt{plotRoss.py} script will generate a figure of the velocity field
calculated for the Ross Ice Shelf.  The results should look very similar to Figures \ref{fig:rossresults1} and \ref{fig:rossresults2}. You can
compare these with similar figures in the paper by \citet{MacAyeal:1996vn}.

\begin{figure}[H!]
	\centering
	\includegraphics[width=10.0cm]{\dir/RossModelVelField.eps}
	\caption{Ross Ice Shelf velocity field calculated by CISM. This figure is generated by \texttt{plotRoss.py}.}
	\label{fig:rossresults1}
\end{figure}
%\FloatBarrier

\begin{figure}[H!]
	\centering
	\includegraphics[width=10.0cm]{\dir/RossModelvsObs.eps}
	\caption{CISM-modeled Ross Ice Shelf speeds vs. those from observations. This figure is generated by \texttt{plotRoss.py}.}
	\label{fig:rossresults2}
\end{figure}
\FloatBarrier


% =====================================
\subsection{Other Tests}
% =====================================
Additional higher-order tests that are still in development (e.g., ``slab" and ``stream") are also included in the \texttt{./tests/higher-order/}
directory. Instructions for how to run these tests are included in each directory. However, since these tests have not yet been validated yet, 
they are for use at your own risk.


